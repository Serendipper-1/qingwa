name: glados-checkin

on:
  workflow_dispatch:
  # push:
  #   branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron:  0 10,16 * * *
      #
      # https://tool.lu/crontab/
      # https://datetime360.com/cn/utc-cst-china-time/
  watch:
    types: started

jobs:
  checkin:
    runs-on: ubuntu-latest
    #if: github.event.repository.owner.id == github.event.sender.id
    # https://p3terx.com/archives/github-actions-manual-trigger.html

    steps:
      - uses: actions/checkout@v2

      - name: Install Python
        run: |
          sudo apt update && \
          sudo apt install python3

      - name: requirements
        run: |
          pip3 install requests
        # if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
      - name: Checkin
        run: |
          python3 checkin.py
        env:
          SERVE: ${{ secrets.SERVE }}
          SCKEY: ${{ secrets.SCKEY }}
          COOKIE: ${{ secrets.COOKIE }}
      - name: Checkin2
        run: |
          chmod +x checkin.sh
          ./checkin.sh
        env:
          COOKIE: ${{ secrets.COOKIE }}

    ### -name:  Checkin
    ###   run: npm install axios
    ###   run: node checkin.js
    ###   env:
    ###     SCKEY: ${{ secrets.SCKEY }}
    ###     COOKIE: ${{ secrets.COOKIE }}
